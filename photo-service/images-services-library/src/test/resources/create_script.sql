CREATE TABLE IMAGES (
  ID          INTEGER GENERATED BY DEFAULT AS IDENTITY,
  NAME        VARCHAR(400)          NULL,
  URL         VARCHAR(200)          NOT NULL,
  USER_ID     VARCHAR(100)          NOT NULL,
  LIKES       INT DEFAULT 0         NOT NULL,
  CREATE_TIME TIMESTAMP DEFAULT NOW NOT NULL,
  PRIMARY KEY (ID)
);

CREATE TABLE COMMENTS (
  ID          INTEGER GENERATED BY DEFAULT AS IDENTITY,
  IMAGE_ID    INT                   NOT NULL,
  USER_ID     VARCHAR(100)          NOT NULL,
  CREATE_TIME TIMESTAMP DEFAULT NOW NOT NULL,
  TEXT        VARCHAR(300)          NULL,
  PRIMARY KEY (ID),
  CONSTRAINT FK_CM_IMG_ID
  FOREIGN KEY (IMAGE_ID)
  REFERENCES IMAGES (ID)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
);

CREATE TABLE LIKES (
  IMAGE_ID INT          NOT NULL,
  USER_ID  VARCHAR(100) NOT NULL,
  PRIMARY KEY (IMAGE_ID, USER_ID),
  CREATE_TIME TIMESTAMP DEFAULT NOW NOT NULL,
  CONSTRAINT FK_LIKES_IMAGE_ID
  FOREIGN KEY (IMAGE_ID)
  REFERENCES IMAGES (ID)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
);

CREATE TABLE USERS (
  NICKNAME           VARCHAR(100),
  EMAIL              VARCHAR(45)  NOT NULL,
  PASSWORD           VARCHAR(150) NOT NULL,
  NAME               VARCHAR(20)  NULL,
  LANGUAGE           VARCHAR(3)   NULL,
  LAST_ACTIVITY_TIME TIMESTAMP    NULL,
  POSTS              INT,
  PRIMARY KEY (NICKNAME)
);